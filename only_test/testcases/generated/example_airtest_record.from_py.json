{
  "testcase_id": "TC_example_airtest_record_from_py",
  "name": "测试 vod 正常播放, 点播节目名称 西语手机端720资源02",
  "description": "测试 vod 正常播放, 点播节目名称 西语手机端720资源02",
  "target_app": "com.mobile.brasiltvmobile",
  "device_info": { "adb_serial": "192.168.100.112:5555" },
  "metadata": {
    "priority": "high",
    "category": "playback",
    "tags": ["vod", "playing"],
    "page_scope": ["home", "search", "search_result", "vod_playing_detail", "playing"],
    "style": "recorded"
  },
  "variables": {
    "search_keyword": "西语手机端720资源02"
  },
  "execution_path": [
    {
      "step": 1,
      "page": "app_initialization",
      "type": "ui",
      "action": "restart",
      "description": "重启应用清理环境状态",
      "timeout": 3
    },
    {
      "step": 2,
      "page": "app_startup",
      "type": "ui",
      "action": "launch",
      "description": "启动应用并等待加载完成",
      "timeout": 5
    },
    {
      "step": 3,
      "page": "home",
      "type": "tool",
      "tool_name": "close_ads",
      "description": "进入 APK 后使用统一策略自动关闭广告/弹窗（连续3次未检测到广告或20秒内结束）",
      "params": {"mode": "continuous", "consecutive_no_ad": 2, "max_duration": 20.0},
      "timeout": 20
    },
    {
      "step": 4,
      "page": "home",
      "type": "ui",
      "action": "click",
      "description": "点击搜索按钮进入搜索页面",
      "target": {
        "priority_selectors": [
          {"resource_id": "com.mobile.brasiltvmobile:id/mVodImageSearch"}
        ]
      },
      "timeout": 5
    },
    {
      "step": 5,
      "page": "search",
      "type": "ui",
      "action": "input",
      "description": "输入搜索关键词",
      "target": {
        "priority_selectors": [
          {"resource_id": "com.mobile.brasiltvmobile:id/searchEt"}
        ]
      },
      "data": {"text": "${search_keyword}", "submit_method": "enter"},
      "timeout": 5
    },
    {
      "step": 6,
      "page": "search_result",
      "type": "ui",
      "action": "click",
      "description": "点击目标节目卡片",
      "target": {
        "priority_selectors": [
          {"resource_id": "com.mobile.brasiltvmobile:id/mPosterName"},
          {"text": "西语手机端720资源02"}
        ],
        "bias": {"dy_px": -100}
      },
      "timeout": 10
    },
    {
      "step": 7,
      "page": "vod_playing_detail",
      "type": "ui",
      "action": "click",
      "description": "点击播放按钮开始播放视频",
      "target": {
        "priority_selectors": [
          {"resource_id": "com.mobile.brasiltvmobile:id/mPlayPauseIcon"}
        ]
      },
      "timeout": 10
    },
    {
      "step": 8,
      "page": "vod_playing_detail",
      "type": "ui",
      "action": "wait_for_elements",
      "description": "等待广告播放完毕（Ads 消失）",
      "target": {
        "priority_selectors": [
          {"text": "Ads"}
        ],
        "disappearance": true
      },
      "timeout": 10,
      "wait_after": 2
    },
    {
      "step": 9,
      "page": "vod_playing_detail",
      "type": "ui",
      "action": "click",
      "description": "点击全屏按钮进入全屏播放模式",
      "target": {
        "priority_selectors": [
          {"resource_id": "com.mobile.brasiltvmobile:id/mImageFullScreen"}
        ]
      },
      "timeout": 10
    }
  ],
  "assertions": [
    {
      "type": "check_playback_state",
      "expected": true,
      "description": "断言验证节目正在正常播放"
    }
  ]
}

